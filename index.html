<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Functional ForeCasting â€¢ ffc</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Functional ForeCasting">
<meta property="og:description" content="Perform functional regression using Generalized Additive Models (GAMs) that enable functional responses to be modelled and predicted with a broad range of predictor effects. The package also handles functional predictors with time-varying coefficients that can be forecasted ahead using a variety of efficient forecasting algorithms, providing unmatched flexibility to model and predict how functional responses change over time.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">ffc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">

<div class="section level1">
<div class="page-header"><h1 id="ffc">ffc<a class="anchor" aria-label="anchor" href="#ffc"></a>
</h1></div>
<!-- badges: start -->

</div>
<div class="section level1">
<h1 id="ffc-1">ffc<a class="anchor" aria-label="anchor" href="#ffc-1"></a>
</h1>
<blockquote>
<p><strong>F</strong>unctional <strong>F</strong>ore<strong>C</strong>asting</p>
</blockquote>
<p>The goal of the <code>ffc</code> ðŸ“¦ is to perform functional regression using Generalized Additive Models (GAMs). The package integrates with the extremely flexible <a href="https://cran.r-project.org/package=mgcv" target="_blank" class="external-link"><code>mgcv</code></a> package to enable functional responses to be modelled and predicted using a broad range of predictor effects. Key among these types of predictors are <em>dynamic functional predictors</em> using a new <code><a href="reference/fts.html">fts()</a></code> term, which sets up functional predictors whose coefficients are modelled as time-varying. These time-varying coefficients can then be forecasted ahead using a variety of efficient forecasting algorithms, providing unmatched flexibility to model and predict how functional responses change over time.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of ffc from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"nicholasjclark/ffc"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="a-brief-example">A brief example<a class="anchor" aria-label="anchor" href="#a-brief-example"></a>
</h2>
<p>Load the in-built Queensland Mortality data, which contains the number of deaths per age category over time in the state of Queensland, Australia</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ffc</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"qld_mortality"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">qld_mortality</span>, <span class="fl">15</span><span class="op">)</span></span>
<span><span class="co">#&gt;    year age    sex deaths population</span></span>
<span><span class="co">#&gt; 1  1980   0 female    190   17699.81</span></span>
<span><span class="co">#&gt; 2  1980   1 female     20   17505.27</span></span>
<span><span class="co">#&gt; 3  1980   2 female      6   17715.56</span></span>
<span><span class="co">#&gt; 4  1980   3 female      6   18080.06</span></span>
<span><span class="co">#&gt; 5  1980   4 female     10   18390.10</span></span>
<span><span class="co">#&gt; 6  1980   5 female      6   18870.54</span></span>
<span><span class="co">#&gt; 7  1980   6 female      1   19641.01</span></span>
<span><span class="co">#&gt; 8  1980   7 female      2   20475.01</span></span>
<span><span class="co">#&gt; 9  1980   8 female      2   21599.01</span></span>
<span><span class="co">#&gt; 10 1980   9 female      7   22170.09</span></span>
<span><span class="co">#&gt; 11 1980  10 female      2   21750.01</span></span>
<span><span class="co">#&gt; 12 1980  11 female      3   20866.51</span></span>
<span><span class="co">#&gt; 13 1980  12 female      1   20384.50</span></span>
<span><span class="co">#&gt; 14 1980  13 female      8   19848.04</span></span>
<span><span class="co">#&gt; 15 1980  14 female     11   19505.02</span></span></code></pre></div>
<p>Visualise the observed mortality curves over time using the log10 scale</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">qld_mortality</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">age</span>,</span>
<span>    y <span class="op">=</span> <span class="va">deaths</span> <span class="op">/</span> <span class="va">population</span>,</span>
<span>    group <span class="op">=</span> <span class="va">year</span>,</span>
<span>    colour <span class="op">=</span> <span class="va">year</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">sex</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_colour_viridis_c</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Observed log(Mortality)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.png" width="100%"></p>
<p>Fit a model to estimate how the log(mortality) curve changed over time using <code>deaths</code> as the outcome and using a time-varying function of <code>age</code> as the primary predictor. Using <code><a href="reference/fts.html">fts()</a></code>, we model the age-death functions hierarchically using thin plate basis functions whose coefficients are allowed to vary over time, where <code>time = 'year'</code>. The hierarchical formulation allows a shared time-varying level to be modelled, along with deviations around that time-varying level for each sex. We use the <code><a href="https://rdrr.io/pkg/mgcv/man/bam.html" class="external-link">bam()</a></code> engine (as opposed to <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam()</a></code>) for parameter estimation, given the large size of the dataset. In future, other engines such as <code>brm()</code> and <code>mvgam()</code>, will be made available for full luxury Bayesian inference.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ffc_gam.html">ffc_gam</a></span><span class="op">(</span></span>
<span>  <span class="va">deaths</span> <span class="op">~</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">population</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">sex</span> <span class="op">+</span></span>
<span>    <span class="co"># Use mean_only = TRUE to model a time-varying level</span></span>
<span>    <span class="fu"><a href="reference/fts.html">fts</a></span><span class="op">(</span></span>
<span>      <span class="va">year</span>,</span>
<span>      mean_only <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      bs <span class="op">=</span> <span class="st">"tp"</span>,</span>
<span>      time_k <span class="op">=</span> <span class="fl">35</span>,</span>
<span>      time_m <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># Model the male/female deviations around the shared mean</span></span>
<span>    <span class="fu"><a href="reference/fts.html">fts</a></span><span class="op">(</span></span>
<span>      <span class="va">age</span>,</span>
<span>      by <span class="op">=</span> <span class="va">sex</span>,</span>
<span>      bs <span class="op">=</span> <span class="st">"tp"</span>,</span>
<span>      time_k <span class="op">=</span> <span class="fl">15</span>,</span>
<span>      time_m <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span>,</span>
<span>  time <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">qld_mortality</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  engine <span class="op">=</span> <span class="st">"bam"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Inspect the model summary; notice in the <code>Formula</code> slot how the basis functions are modelled as <code>by</code> variables within independent smooths of <code>year</code> that share their smoothing parameters</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Family: poisson </span></span>
<span><span class="co">#&gt; Link function: log </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:</span></span>
<span><span class="co">#&gt; deaths ~ sex + offset(log(population)) + s(year, by = fts_year1_mean, </span></span>
<span><span class="co">#&gt;     bs = "tp", k = 35, m = 1, id = 1) + s(year, by = fts_bs_s_age_bysexfemale_1, </span></span>
<span><span class="co">#&gt;     bs = "tp", k = 15, m = 1, id = 2) + s(year, by = fts_bs_s_age_bysexfemale_2, </span></span>
<span><span class="co">#&gt;     bs = "tp", k = 15, m = 1, id = 2) + s(year, by = fts_bs_s_age_bysexfemale_3, </span></span>
<span><span class="co">#&gt;     bs = "tp", k = 15, m = 1, id = 2) + s(year, by = fts_bs_s_age_bysexfemale_4, </span></span>
<span><span class="co">#&gt;     bs = "tp", k = 15, m = 1, id = 2) + s(year, by = fts_bs_s_age_bysexfemale_5, </span></span>
<span><span class="co">#&gt;     bs = "tp", k = 15, m = 1, id = 2) + s(year, by = fts_bs_s_age_bysexfemale_6, </span></span>
<span><span class="co">#&gt;     bs = "tp", k = 15, m = 1, id = 2) + s(year, by = fts_bs_s_age_bysexfemale_7, </span></span>
<span><span class="co">#&gt;     bs = "tp", k = 15, m = 1, id = 2) + s(year, by = fts_bs_s_age_bysexfemale_8, </span></span>
<span><span class="co">#&gt;     bs = "tp", k = 15, m = 1, id = 2) + s(year, by = fts_bs_s_age_bysexfemale_9, </span></span>
<span><span class="co">#&gt;     bs = "tp", k = 15, m = 1, id = 2) + s(year, by = fts_bs_s_age_bysexmale_1, </span></span>
<span><span class="co">#&gt;     bs = "tp", k = 15, m = 1, id = 2) + s(year, by = fts_bs_s_age_bysexmale_2, </span></span>
<span><span class="co">#&gt;     bs = "tp", k = 15, m = 1, id = 2) + s(year, by = fts_bs_s_age_bysexmale_3, </span></span>
<span><span class="co">#&gt;     bs = "tp", k = 15, m = 1, id = 2) + s(year, by = fts_bs_s_age_bysexmale_4, </span></span>
<span><span class="co">#&gt;     bs = "tp", k = 15, m = 1, id = 2) + s(year, by = fts_bs_s_age_bysexmale_5, </span></span>
<span><span class="co">#&gt;     bs = "tp", k = 15, m = 1, id = 2) + s(year, by = fts_bs_s_age_bysexmale_6, </span></span>
<span><span class="co">#&gt;     bs = "tp", k = 15, m = 1, id = 2) + s(year, by = fts_bs_s_age_bysexmale_7, </span></span>
<span><span class="co">#&gt;     bs = "tp", k = 15, m = 1, id = 2) + s(year, by = fts_bs_s_age_bysexmale_8, </span></span>
<span><span class="co">#&gt;     bs = "tp", k = 15, m = 1, id = 2) + s(year, by = fts_bs_s_age_bysexmale_9, </span></span>
<span><span class="co">#&gt;     bs = "tp", k = 15, m = 1, id = 2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parametric coefficients:</span></span>
<span><span class="co">#&gt;              Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept) -5.648962   0.004043 -1397.3   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; sexmale      0.576491   0.004981   115.7   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Approximate significance of smooth terms:</span></span>
<span><span class="co">#&gt;                                       edf Ref.df Chi.sq p-value    </span></span>
<span><span class="co">#&gt; s(year):fts_year1_mean             32.132 34.000  13231  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; s(year):fts_bs_s_age_bysexfemale_1 10.900 12.503  16347  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; s(year):fts_bs_s_age_bysexfemale_2  8.447 10.019  10379  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; s(year):fts_bs_s_age_bysexfemale_3 10.230 11.993   9668  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; s(year):fts_bs_s_age_bysexfemale_4  8.431 10.173   8575  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; s(year):fts_bs_s_age_bysexfemale_5  9.712 11.552   8476  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; s(year):fts_bs_s_age_bysexfemale_6  8.082  9.678   8746  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; s(year):fts_bs_s_age_bysexfemale_7  9.568 11.356   7817  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; s(year):fts_bs_s_age_bysexfemale_8  7.156  7.834  11575  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; s(year):fts_bs_s_age_bysexfemale_9  6.714  7.907   6110  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; s(year):fts_bs_s_age_bysexmale_1   11.400 12.813  19904  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; s(year):fts_bs_s_age_bysexmale_2    9.299 10.761  11592  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; s(year):fts_bs_s_age_bysexmale_3   11.094 12.785  12961  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; s(year):fts_bs_s_age_bysexmale_4    9.494 11.291  12259  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; s(year):fts_bs_s_age_bysexmale_5   10.654 12.497  14720  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; s(year):fts_bs_s_age_bysexmale_6    8.898 10.721  12319  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; s(year):fts_bs_s_age_bysexmale_7   10.098 11.999  11878  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; s(year):fts_bs_s_age_bysexmale_8    7.148  7.738  13955  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; s(year):fts_bs_s_age_bysexmale_9    6.167  7.130   6963  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; R-sq.(adj) =  0.986   Deviance explained = 97.6%</span></span>
<span><span class="co">#&gt; fREML =  21810  Scale est. = 1         n = 8282</span></span></code></pre></div>
<p>View predicted functional curves using a fixed offset (where <code>population = 1</code>), which allows us to calculate a standardized rate of mortality</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">newdat</span> <span class="op">&lt;-</span> <span class="va">qld_mortality</span></span>
<span><span class="va">newdat</span><span class="op">$</span><span class="va">population</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">newdat</span><span class="op">$</span><span class="va">preds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span></span>
<span>  <span class="va">mod</span>,</span>
<span>  newdata <span class="op">=</span> <span class="va">newdat</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"response"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">newdat</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">age</span>,</span>
<span>    y <span class="op">=</span> <span class="va">preds</span>,</span>
<span>    group <span class="op">=</span> <span class="va">year</span>,</span>
<span>    colour <span class="op">=</span> <span class="va">year</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">sex</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_colour_viridis_c</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Expected log10(Mortality)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-6-1.png" width="100%"></p>
<p>Using support from the <code>marginaleffects</code> ðŸ“¦, we can make easily predict changes in mortality rate for specific age groups. For example, here is the expected decline in mortality rate for 17 year-olds in Queensland over the study period</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://marginaleffects.com/" class="external-link">marginaleffects</a></span><span class="op">)</span></span>
<span><span class="fu">plot_predictions</span><span class="op">(</span></span>
<span>  <span class="va">mod</span>,</span>
<span>  by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"year"</span>, <span class="st">"sex"</span><span class="op">)</span>,</span>
<span>  newdata <span class="op">=</span> <span class="fu">datagrid</span><span class="op">(</span></span>
<span>    age <span class="op">=</span> <span class="fl">17</span>,</span>
<span>    year <span class="op">=</span> <span class="va">unique</span>,</span>
<span>    sex <span class="op">=</span> <span class="va">unique</span>,</span>
<span>    population <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"response"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Expected log10(Mortality)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-7-1.png" width="100%"></p>
<p>And here are the slopes of this change</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot_slopes</span><span class="op">(</span></span>
<span>  <span class="va">mod</span>,</span>
<span>  variables <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>  by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"year"</span>, <span class="st">"sex"</span><span class="op">)</span>,</span>
<span>  newdata <span class="op">=</span> <span class="fu">datagrid</span><span class="op">(</span></span>
<span>    age <span class="op">=</span> <span class="fl">17</span>,</span>
<span>    year <span class="op">=</span> <span class="va">unique</span>,</span>
<span>    sex <span class="op">=</span> <span class="va">unique</span>,</span>
<span>    population <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"response"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"1st derivative of mortality rate change"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span></span>
<span>    yintercept <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"dashed"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-8-1.png" width="100%"></p>
<p>The time-varying coefficients can be extracted into a <code>tidy</code> format using <code><a href="reference/fts_coefs.ffc_gam.html">fts_coefs()</a></code>, which will facilitate the use of time series models to enable efficient forecasting of the entire curve into the future. Using <code>summary = FALSE</code> will return draws of each coefficient time series from the modelâ€™s empirical Bayesian posterior distribution (you can control the number of draws that are returned using the <code>times</code> argument):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">functional_coefs</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fts_coefs.ffc_gam.html">fts_coefs</a></span><span class="op">(</span></span>
<span>  <span class="va">mod</span>,</span>
<span>  summary <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  times <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span><span class="va">functional_coefs</span></span>
<span><span class="co">#&gt; # A tibble: 7,790 Ã— 5</span></span>
<span><span class="co">#&gt;    .basis         .time .estimate .realisation  year</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;          &lt;int&gt;     &lt;dbl&gt;        &lt;int&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt;  1 fts_year1_mean  1980     0.383            1  1980</span></span>
<span><span class="co">#&gt;  2 fts_year1_mean  1981     0.361            1  1981</span></span>
<span><span class="co">#&gt;  3 fts_year1_mean  1982     0.401            1  1982</span></span>
<span><span class="co">#&gt;  4 fts_year1_mean  1983     0.323            1  1983</span></span>
<span><span class="co">#&gt;  5 fts_year1_mean  1984     0.314            1  1984</span></span>
<span><span class="co">#&gt;  6 fts_year1_mean  1985     0.320            1  1985</span></span>
<span><span class="co">#&gt;  7 fts_year1_mean  1986     0.275            1  1986</span></span>
<span><span class="co">#&gt;  8 fts_year1_mean  1987     0.252            1  1987</span></span>
<span><span class="co">#&gt;  9 fts_year1_mean  1988     0.231            1  1988</span></span>
<span><span class="co">#&gt; 10 fts_year1_mean  1989     0.252            1  1989</span></span>
<span><span class="co">#&gt; # â„¹ 7,780 more rows</span></span></code></pre></div>
<p>The basis function coefficient time series can be plotted using <code><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot()</a></code></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">functional_coefs</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-10-1.png" width="100%"></p>
<p>Clearly there is a lot of structure and dependence here, suggesting that a dynamic factor model fitted to these coefficient time series would be valuable for creating functional forecasts. But for now we can apply any model from the <code>fable</code> ðŸ“¦ to these replicate time series and generate future forecast realisations, which can be summarised to approximate the full uncertainty in our coefficient forecast distributions. Again here you can control the number of forecast paths that are simulated from the underlying time series models using the <code>times</code> argument</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">functional_fc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/forecast.html" class="external-link">forecast</a></span><span class="op">(</span></span>
<span>  object <span class="op">=</span> <span class="va">functional_coefs</span>,</span>
<span>  h <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  times <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Registered S3 method overwritten by 'tsibble':</span></span>
<span><span class="co">#&gt;   method               from </span></span>
<span><span class="co">#&gt;   as_tibble.grouped_df dplyr</span></span>
<span><span class="va">functional_fc</span></span>
<span><span class="co">#&gt; # A tsibble: 4,750 x 6 [1Y]</span></span>
<span><span class="co">#&gt; # Key:       .basis, .realisation, .model, .rep [950]</span></span>
<span><span class="co">#&gt;    .basis                     .realisation .model .time .rep   .sim</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;                             &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 fts_bs_s_age_bysexfemale_1            1 ARIMA   2021 1      4.74</span></span>
<span><span class="co">#&gt;  2 fts_bs_s_age_bysexfemale_1            1 ARIMA   2022 1      4.74</span></span>
<span><span class="co">#&gt;  3 fts_bs_s_age_bysexfemale_1            1 ARIMA   2023 1      4.73</span></span>
<span><span class="co">#&gt;  4 fts_bs_s_age_bysexfemale_1            1 ARIMA   2024 1      4.74</span></span>
<span><span class="co">#&gt;  5 fts_bs_s_age_bysexfemale_1            1 ARIMA   2025 1      4.76</span></span>
<span><span class="co">#&gt;  6 fts_bs_s_age_bysexfemale_1            1 ARIMA   2021 2      4.74</span></span>
<span><span class="co">#&gt;  7 fts_bs_s_age_bysexfemale_1            1 ARIMA   2022 2      4.74</span></span>
<span><span class="co">#&gt;  8 fts_bs_s_age_bysexfemale_1            1 ARIMA   2023 2      4.73</span></span>
<span><span class="co">#&gt;  9 fts_bs_s_age_bysexfemale_1            1 ARIMA   2024 2      4.73</span></span>
<span><span class="co">#&gt; 10 fts_bs_s_age_bysexfemale_1            1 ARIMA   2025 2      4.74</span></span>
<span><span class="co">#&gt; # â„¹ 4,740 more rows</span></span></code></pre></div>
<p>Another example showing univariate time series modelling and forecasting</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fable.tidyverts.org" class="external-link">fable</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tsibble.tidyverts.org" class="external-link">tsibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<p>Our aim here is to forecast the number of domestic holiday travellers to Melbourne, Australia. The data can be found in the <code><a href="https://tsibble.tidyverts.org/reference/tourism.html" class="external-link">tsibble::tourism</a></code> data set. For now we need to explicitly add the <code>quarter</code> and <code>time</code> variables to the data, but in future this will be done automatically for seamless integration with the <code>tsibbleverse</code></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tourism_melb</span> <span class="op">&lt;-</span> <span class="va">tourism</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">Region</span> <span class="op">==</span> <span class="st">"Melbourne"</span>,</span>
<span>    <span class="va">Purpose</span> <span class="op">==</span> <span class="st">"Holiday"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    quarter <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/quarter.html" class="external-link">quarter</a></span><span class="op">(</span><span class="va">Quarter</span><span class="op">)</span>,</span>
<span>    time <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/row_number.html" class="external-link">row_number</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">tourism_melb</span></span>
<span><span class="co">#&gt; # A tsibble: 80 x 7 [1Q]</span></span>
<span><span class="co">#&gt; # Key:       Region, State, Purpose [1]</span></span>
<span><span class="co">#&gt;    Quarter Region    State    Purpose Trips quarter  time</span></span>
<span><span class="co">#&gt;      &lt;qtr&gt; &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;   &lt;dbl&gt;   &lt;int&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt;  1 1998 Q1 Melbourne Victoria Holiday  428.       1     1</span></span>
<span><span class="co">#&gt;  2 1998 Q2 Melbourne Victoria Holiday  424.       2     2</span></span>
<span><span class="co">#&gt;  3 1998 Q3 Melbourne Victoria Holiday  450.       3     3</span></span>
<span><span class="co">#&gt;  4 1998 Q4 Melbourne Victoria Holiday  451.       4     4</span></span>
<span><span class="co">#&gt;  5 1999 Q1 Melbourne Victoria Holiday  412.       1     5</span></span>
<span><span class="co">#&gt;  6 1999 Q2 Melbourne Victoria Holiday  355.       2     6</span></span>
<span><span class="co">#&gt;  7 1999 Q3 Melbourne Victoria Holiday  362.       3     7</span></span>
<span><span class="co">#&gt;  8 1999 Q4 Melbourne Victoria Holiday  342.       4     8</span></span>
<span><span class="co">#&gt;  9 2000 Q1 Melbourne Victoria Holiday  434.       1     9</span></span>
<span><span class="co">#&gt; 10 2000 Q2 Melbourne Victoria Holiday  403.       2    10</span></span>
<span><span class="co">#&gt; # â„¹ 70 more rows</span></span></code></pre></div>
<p>Split into training and testing folds. We wil aim to forecast the last 5 quarters of the data</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">tourism_melb</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">75</span><span class="op">)</span></span>
<span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">tourism_melb</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_tail</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p>Now fit an <code>ffc_gam</code>. We use time-varying level and time-varying seasonality components, together with a Tweedie observation model (because our outcome, <code>Trips</code>, consists of non-negative real values). This model is simpler so we use the <code>'gam'</code> engine for fitting:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ffc_gam.html">ffc_gam</a></span><span class="op">(</span></span>
<span>  <span class="va">Trips</span> <span class="op">~</span></span>
<span>    <span class="co"># Use mean_only = TRUE to model a time-varying mean</span></span>
<span>    <span class="fu"><a href="reference/fts.html">fts</a></span><span class="op">(</span></span>
<span>      <span class="va">time</span>,</span>
<span>      mean_only <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      time_k <span class="op">=</span> <span class="fl">50</span>,</span>
<span>      time_m <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># Time-varying seasonality</span></span>
<span>    <span class="fu"><a href="reference/fts.html">fts</a></span><span class="op">(</span></span>
<span>      <span class="va">quarter</span>,</span>
<span>      bs <span class="op">=</span> <span class="st">"tp"</span>,</span>
<span>      k <span class="op">=</span> <span class="fl">4</span>,</span>
<span>      time_k <span class="op">=</span> <span class="fl">15</span>,</span>
<span>      time_m <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span>,</span>
<span>  time <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">train</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/Tweedie.html" class="external-link">tw</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  engine <span class="op">=</span> <span class="st">"gam"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Draw the time-varying basis coefficients, this time using <code>gratia</code></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gratia</span><span class="fu">::</span><span class="fu">draw</span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-16-1.png" width="100%"></p>
<p>Compute forecast distribution by fitting the basis coefficient time series models in parallel (which is automatically supported within the <code>fable</code> package). Here we fit independent exponential smoothing models to each coefficient time series</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/forecast.html" class="external-link">forecast</a></span><span class="op">(</span></span>
<span>  object <span class="op">=</span> <span class="va">mod</span>,</span>
<span>  newdata <span class="op">=</span> <span class="va">test</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"ETS"</span>,</span>
<span>  summary <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Convert resulting forecasts to a <code>fable</code> object for automatic plotting and/or scoring of forecasts</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test</span><span class="op">[[</span><span class="st">"value"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fc</span></span>
<span></span>
<span><span class="va">fc_ffc</span> <span class="op">&lt;-</span> <span class="fu">fabletools</span><span class="fu">:::</span><span class="fu">build_fable</span><span class="op">(</span></span>
<span>  <span class="va">test</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"Trips"</span>,</span>
<span>  distribution <span class="op">=</span> <span class="st">"value"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Plot the forecast distribution along with the observed data</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fc_ffc</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">test</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Trips</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"FFC forecast"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-19-1.png" width="100%"></p>
<p>Compare to forecasts from automatic ARIMA and ETS models, which are simpler to code and of course a bit faster</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">train</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://fabletools.tidyverts.org/reference/model.html" class="external-link">model</a></span><span class="op">(</span></span>
<span>    arima <span class="op">=</span> <span class="fu"><a href="https://fable.tidyverts.org/reference/ARIMA.html" class="external-link">ARIMA</a></span><span class="op">(</span><span class="va">Trips</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/forecast.html" class="external-link">forecast</a></span><span class="op">(</span></span>
<span>    h <span class="op">=</span> <span class="fl">5</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">test</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Trips</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"ARIMA forecast"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-20-1.png" width="100%"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">train</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://fabletools.tidyverts.org/reference/model.html" class="external-link">model</a></span><span class="op">(</span></span>
<span>    ets <span class="op">=</span> <span class="fu"><a href="https://fable.tidyverts.org/reference/ETS.html" class="external-link">ETS</a></span><span class="op">(</span><span class="va">Trips</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/forecast.html" class="external-link">forecast</a></span><span class="op">(</span></span>
<span>    h <span class="op">=</span> <span class="fl">5</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">test</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Trips</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"ETS forecast"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-21-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="getting-help">Getting help<a class="anchor" aria-label="anchor" href="#getting-help"></a>
</h2>
<p>If you encounter a clear bug, please file an issue with a minimal reproducible example on <a href="https://github.com/nicholasjclark/ffc/issues" class="external-link">GitHub</a></p>
</div>
<div class="section level2">
<h2 id="contributing">Contributing<a class="anchor" aria-label="anchor" href="#contributing"></a>
</h2>
<p>Contributions are very welcome, but please see our <a href="https://github.com/nicholasjclark/ffc/blob/main/.github/CODE_OF_CONDUCT.md" class="external-link">Code of Conduct</a> when you are considering changes that you would like to make.</p>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>The <code>ffc</code> project is licensed under an <code>MIT</code> open source license</p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ffc</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Nicholas J Clark <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-7131-3301" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://CRAN.R-project.org/package=ffc" class="external-link"><img src="https://www.r-pkg.org/badges/version/ffc" alt="CRAN status"></a></li>
<li><a href="https://github.com/nicholasjclark/ffc/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/nicholasjclark/ffc/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/nicholasjclark/ffc" class="external-link"><img src="https://codecov.io/gh/nicholasjclark/ffc/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Nicholas J Clark.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

      </footer>
</div>






  </body>
</html>
