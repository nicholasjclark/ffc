% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/forecast.R
\name{forecast.ffc_gam}
\alias{forecast.ffc_gam}
\title{Forecasting \code{ffc_gam} models}
\usage{
\method{forecast}{ffc_gam}(
  object,
  newdata,
  type = "response",
  model = "ARIMA",
  stationary = FALSE,
  summary = TRUE,
  robust = TRUE,
  probs = c(0.025, 0.1, 0.9, 0.975),
  ...
)
}
\arguments{
\item{object}{An object of class \code{ffc_gam}. See \code{\link[=ffc_gam]{ffc_gam()}}}

\item{newdata}{\code{dataframe} or \code{list} of test data containing the
same variables that were included in the original \code{data} used to fit the
model. The covariate information in \code{newdata}, along with the temporal information
indexed by the \code{time} variable in the original call to \code{ffc_gam()}, will be used to
generate forecasts from the fitted model equations}

\item{type}{When this has the value \code{link}, the linear predictor is calculated
on the link scale. If \code{expected} is used, predictions reflect the expectation
of the response (the mean) but ignore uncertainty in the observation process.
When \code{response} is used (the default), the predictions take uncertainty in the observation
process into account to return predictions on the outcome scale}

\item{model}{A \code{character} string representing a valid univariate model definition
from the \pkg{fable} package or one of the built-in Bayesian dynamic
factor models. Note that if a \pkg{fable} model is used,
the chosen method must have an associated
\code{generate()} method in order to simulate forecast realisations. Valid models
currently include: \code{'ARDF'}, \code{'GPDF'}, '\code{VARDF},
\code{'ETS'}, \code{'ARIMA'}, \code{'AR'}, \code{'RW'}, \code{'NAIVE'}, and \code{'NNETAR'}}

\item{stationary}{If \code{TRUE}, the fitted time series models are
constrained to be stationary. Default is \code{FALSE}. This option
only works when \code{model == 'ARIMA'}}

\item{summary}{Should summary statistics be returned instead of the raw values?
Default is \code{TRUE}}

\item{robust}{If \code{FALSE} (the default) the mean is used as the measure of
central tendency and the standard deviation as the measure of variability.
If \code{TRUE}, the median and the median absolute deviation (MAD) are applied instead.
Only used if \code{summary} is \code{TRUE}}

\item{probs}{The percentiles to be computed by the \code{quantile()} function.
Only used if \code{summary} is \code{TRUE}}

\item{...}{Additional arguments for Stan dynamic factor models (ARDF, VARDF, GPDF):
\describe{
\item{K}{Number of latent factors (default: 2). Must be positive.}
\item{lag}{Number of time lags for autoregressive terms (default: 1). Must be positive.}
\item{chains}{Number of MCMC chains (default: 4)}
\item{iter}{Total iterations per chain (default: 500)}
\item{warmup}{Warmup iterations per chain (default: iter/2)}
\item{cores}{Number of CPU cores to use (default: min(chains, available cores))}
\item{adapt_delta}{Target acceptance rate (default: 0.75)}
\item{max_treedepth}{Maximum tree depth (default: 9)}
\item{times}{Number of posterior samples to draw for coefficient forecasting.
For Stan models, this is automatically set to (iter - warmup) * chains
to ensure dimension consistency. Minimum 100 total posterior samples required.}
}}
}
\value{
Predicted values on the appropriate scale.
If \code{summary == FALSE}, the output is a matrix. If \code{summary == TRUE}, the output
is a tidy \code{tbl_df / data.frame}
}
\description{
Forecasting \code{ffc_gam} models
}
\details{
\strong{Forecasting Methodology:}

This function implements a two-stage forecasting approach for functional regression
models with time-varying coefficients of the form:
\deqn{y_t = \sum_{j=1}^{J} \beta_j(t) B_j(x) + \epsilon_t}
where \eqn{\beta_j(t)} are time-varying coefficients and \eqn{B_j(x)} are basis functions.

\enumerate{
\item \strong{Extract basis coefficients:} Time-varying functional coefficients
\eqn{\beta_j(t)} are extracted from the fitted GAM as time series
\item \strong{Forecast coefficients:} These coefficient time series are forecast
using either Stan dynamic factor models (ARDF/VARDF/GPDF) or ARIMA models
\item \strong{Reconstruct forecasts:} Forecasted coefficients are combined:
\deqn{\hat{y}_{t+h} = \sum_{j=1}^{J} \hat{\beta}_j(t+h) B_j(x)}
\item \strong{Combine uncertainties:} Multiple uncertainty sources are integrated
hierarchically (see Uncertainty Quantification section)
}

\strong{Uncertainty Quantification:}

Forecast uncertainty is captured through a hierarchical structure:

\emph{Within Stan dynamic factor models:}
\itemize{
\item \strong{Process uncertainty:} Factor dynamics, autoregressive terms, factor loadings
\item \strong{Observation uncertainty:} Series-specific error terms (\eqn{\sigma_{obs}})
}

\emph{Final combination in linear predictor space:}
\itemize{
\item \strong{Stan forecast samples:} Already incorporate process + observation uncertainty
\item \strong{GAM parameter uncertainty:} Random draws from \eqn{N(\hat{\boldsymbol{\theta}}, \mathbf{V})}
where \eqn{\mathbf{V}} is the coefficient covariance matrix
}

These components are combined additively: \eqn{\text{Stan forecasts} + \text{GAM uncertainty}}

\strong{Model Selection:}

\itemize{
\item \strong{Stan factor models (ARDF/VARDF/GPDF):} Used for multivariate
forecasting of non-mean basis coefficients. Capture dependencies between
coefficient series and assume zero-centered time series for efficiency.
\item \strong{ARIMA models:} Used for mean basis coefficients (which operate
at non-zero levels) and when \code{model = "ARIMA"} is specified.
}

\strong{Important Note on \code{times} Parameter:}

For Stan dynamic factor models, the \code{times} parameter is automatically set to
\code{(iter - warmup) * chains} to ensure dimensional consistency. Any user-specified
\code{times} value will be ignored with a warning. For ARIMA models, \code{times} can be
specified freely and controls the number of posterior draws.
}
\seealso{
\code{\link[=ffc_gam]{ffc_gam()}}, \code{\link[=fts]{fts()}}, \code{\link[=forecast.fts_ts]{forecast.fts_ts()}}
}
\author{
Nicholas J Clark
}
